---
interface Props {
  title: string;
  description: string;
  date: Date;
  category: string;
  tags: string[];
  thumbnail?: string;
  slug: string;
}

const { title, description, date, category, tags, thumbnail, slug } = Astro.props;

const formattedDate = date.toLocaleDateString('ja-JP', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
});
const isoDate = date.toISOString();
---

<article class="article-card">
  <a href={`/blog/${slug}/`} class="card-link" tabindex="-1" aria-hidden="true">
    <div class="card-thumbnail">
      {thumbnail ? (
        <img src={thumbnail} alt={title} width="400" height="225" loading="lazy" />
      ) : (
        <div class="card-thumbnail-placeholder" aria-hidden="true">
          <span>⚔</span>
        </div>
      )}
    </div>
  </a>

  <div class="card-body">
    <div class="card-meta">
      <a href={`/category/${category}/`} class="category-badge">{category}</a>
      <time datetime={isoDate} class="card-date">{formattedDate}</time>
    </div>

    <h2 class="card-title">
      <a href={`/blog/${slug}/`}>{title}</a>
    </h2>

    <p class="card-description">{description}</p>

    {tags.length > 0 && (
      <ul class="tag-list" aria-label="タグ">
        {tags.slice(0, 3).map((tag) => (
          <li class="tag">#{tag}</li>
        ))}
      </ul>
    )}
  </div>
</article>

<style>
  .article-card {
    background: var(--color-shiro);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.2s, transform 0.2s;
  }

  .article-card:hover {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
  }

  .card-link {
    display: block;
    overflow: hidden;
  }

  .card-thumbnail {
    aspect-ratio: 16 / 9;
    overflow: hidden;
    background: var(--color-hana);
  }

  .card-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
    display: block;
  }

  .article-card:hover .card-thumbnail img {
    transform: scale(1.03);
  }

  .card-thumbnail-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    background: linear-gradient(135deg, #f5f0e8, #e8dfc8);
    color: var(--color-kogane);
  }

  .card-body {
    padding: var(--spacing-md);
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .card-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
  }

  .category-badge {
    display: inline-block;
    background: var(--color-ake);
    color: var(--color-shiro);
    font-size: 0.75rem;
    font-weight: 700;
    padding: 0.2em 0.6em;
    border-radius: 2px;
    text-decoration: none;
    white-space: nowrap;
  }

  .category-badge:hover {
    background: #a93226;
    text-decoration: none;
  }

  .card-date {
    font-size: 0.8125rem;
    color: var(--color-nezumi);
  }

  .card-title {
    font-family: var(--font-serif);
    font-size: 1.0625rem;
    line-height: 1.45;
  }

  .card-title a {
    color: var(--color-sumi);
    text-decoration: none;
  }

  .card-title a:hover {
    color: var(--color-ake);
    text-decoration: none;
  }

  .card-description {
    font-size: 0.875rem;
    color: var(--color-nezumi);
    line-height: 1.65;
    flex: 1;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .tag-list {
    list-style: none;
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
    margin-top: auto;
  }

  .tag {
    font-size: 0.75rem;
    color: var(--color-nezumi);
    background: var(--color-hana);
    border: 1px solid var(--color-border);
    padding: 0.15em 0.5em;
    border-radius: 2px;
  }
</style>
